2025-07-26 13:41:13 | INFO     | ================================================================================
2025-07-26 13:41:13 | INFO     | 实验日志开始: DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat
2025-07-26 13:41:13 | INFO     | 日志文件: ./result/0726_1341_DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat/training.log
2025-07-26 13:41:13 | INFO     | 开始时间: 2025-07-26 13:41:13
2025-07-26 13:41:13 | INFO     | ================================================================================
2025-07-26 13:41:13 | INFO     | ⚙️ 实验配置:
2025-07-26 13:41:13 | INFO     |    task_name: classification
2025-07-26 13:41:13 | INFO     |    is_training: 1
2025-07-26 13:41:13 | INFO     |    model_id: test
2025-07-26 13:41:13 | INFO     |    model: DualGAFNet
2025-07-26 13:41:13 | INFO     |    data: DualGAF
2025-07-26 13:41:13 | INFO     |    root_path: ./dataset/SAHU/direct_5_working
2025-07-26 13:41:13 | INFO     |    step: 96
2025-07-26 13:41:13 | INFO     |    checkpoints: ./checkpoints/
2025-07-26 13:41:13 | INFO     |    num_class: 10
2025-07-26 13:41:13 | INFO     |    result_path: ./result/
2025-07-26 13:41:13 | INFO     |    test_size: 0.2
2025-07-26 13:41:13 | INFO     |    rows: None
2025-07-26 13:41:13 | INFO     |    seq_len: 96
2025-07-26 13:41:13 | INFO     |    enc_in: 26
2025-07-26 13:41:13 | INFO     |    d_model: 512
2025-07-26 13:41:13 | INFO     |    n_heads: 8
2025-07-26 13:41:13 | INFO     |    e_layers: 2
2025-07-26 13:41:13 | INFO     |    d_layers: 1
2025-07-26 13:41:13 | INFO     |    d_ff: 2048
2025-07-26 13:41:13 | INFO     |    moving_avg: 25
2025-07-26 13:41:13 | INFO     |    factor: 1
2025-07-26 13:41:13 | INFO     |    distil: True
2025-07-26 13:41:13 | INFO     |    dropout: 0.1
2025-07-26 13:41:13 | INFO     |    embed: timeF
2025-07-26 13:41:13 | INFO     |    activation: gelu
2025-07-26 13:41:13 | INFO     |    use_norm: 1
2025-07-26 13:41:13 | INFO     |    gaf_method: summation
2025-07-26 13:41:13 | INFO     |    feature_dim: 128
2025-07-26 13:41:13 | INFO     |    data_type_method: uint8
2025-07-26 13:41:13 | INFO     |    use_attention: True
2025-07-26 13:41:13 | INFO     |    hidden_dim: 64
2025-07-26 13:41:13 | INFO     |    sample_size: 1000
2025-07-26 13:41:13 | INFO     |    channel_groups: None
2025-07-26 13:41:13 | INFO     |    hvac_groups: None
2025-07-26 13:41:13 | INFO     |    extractor_type: dilated
2025-07-26 13:41:13 | INFO     |    fusion_type: concat
2025-07-26 13:41:13 | INFO     |    attention_type: channel
2025-07-26 13:41:13 | INFO     |    classifier_type: mlp
2025-07-26 13:41:13 | INFO     |    use_statistical_features: True
2025-07-26 13:41:13 | INFO     |    stat_type: basic
2025-07-26 13:41:13 | INFO     |    multimodal_fusion_strategy: concat
2025-07-26 13:41:13 | INFO     |    use_signal_level_stats: False
2025-07-26 13:41:13 | INFO     |    signal_stat_type: comprehensive
2025-07-26 13:41:13 | INFO     |    signal_stat_fusion_strategy: concat_project
2025-07-26 13:41:13 | INFO     |    signal_stat_feature_dim: 32
2025-07-26 13:41:13 | INFO     |    use_diff_branch: True
2025-07-26 13:41:13 | INFO     |    ablation_mode: none
2025-07-26 13:41:13 | INFO     |    backbone_type: resnet18
2025-07-26 13:41:13 | INFO     |    use_sum_branch: True
2025-07-26 13:41:13 | INFO     |    num_workers: 0
2025-07-26 13:41:13 | INFO     |    cuda_debug: False
2025-07-26 13:41:13 | INFO     |    gpu_memory_fraction: 0.9
2025-07-26 13:41:13 | INFO     |    safe_mode: True
2025-07-26 13:41:13 | INFO     |    drop_last_batch: True
2025-07-26 13:41:13 | INFO     |    itr: 1
2025-07-26 13:41:13 | INFO     |    train_epochs: 300
2025-07-26 13:41:13 | INFO     |    batch_size: 4
2025-07-26 13:41:13 | INFO     |    patience: 15
2025-07-26 13:41:13 | INFO     |    learning_rate: 0.0001
2025-07-26 13:41:13 | INFO     |    des: dilated+concat+channel+mlp
2025-07-26 13:41:13 | INFO     |    loss: MSE
2025-07-26 13:41:13 | INFO     |    lradj: type1
2025-07-26 13:41:13 | INFO     |    lr_scheduler_type: f1_based
2025-07-26 13:41:13 | INFO     |    lr_loss_weight: 0.3
2025-07-26 13:41:13 | INFO     |    lr_f1_weight: 0.7
2025-07-26 13:41:13 | INFO     |    use_amp: False
2025-07-26 13:41:13 | INFO     |    gradient_accumulation_steps: 2
2025-07-26 13:41:13 | INFO     |    enable_auto_gradient_accumulation: True
2025-07-26 13:41:13 | INFO     |    loss_type: ce
2025-07-26 13:41:13 | INFO     |    label_smoothing: 0.1
2025-07-26 13:41:13 | INFO     |    focal_alpha: 1.0
2025-07-26 13:41:13 | INFO     |    focal_gamma: 2.0
2025-07-26 13:41:13 | INFO     |    confidence_penalty_beta: 0.1
2025-07-26 13:41:13 | INFO     |    use_timm_loss: True
2025-07-26 13:41:13 | INFO     |    adaptive_initial_smoothing: 0.2
2025-07-26 13:41:13 | INFO     |    adaptive_final_smoothing: 0.05
2025-07-26 13:41:13 | INFO     |    adaptive_decay_epochs: 30
2025-07-26 13:41:13 | INFO     |    enable_class_weights: False
2025-07-26 13:41:13 | INFO     |    class_weights: None
2025-07-26 13:41:13 | INFO     |    loss_preset: None
2025-07-26 13:41:13 | INFO     |    n_jobs: 1
2025-07-26 13:41:13 | INFO     |    use_multiprocessing: False
2025-07-26 13:41:13 | INFO     |    chunk_size: 800
2025-07-26 13:41:13 | INFO     |    disable_parallel: True
2025-07-26 13:41:13 | INFO     |    use_shared_memory: False
2025-07-26 13:41:13 | INFO     |    disable_shared_memory: False
2025-07-26 13:41:13 | INFO     |    use_gpu: True
2025-07-26 13:41:13 | INFO     |    gpu: 0
2025-07-26 13:41:13 | INFO     |    gpu_type: cuda
2025-07-26 13:41:13 | INFO     |    use_multi_gpu: False
2025-07-26 13:41:13 | INFO     |    devices: 0,1,2,3
2025-07-26 13:41:13 | INFO     |    device: cuda:0
2025-07-26 13:41:13 | INFO     |    feature_columns: ['CHWC_VLV', 'CHWC_VLV_DM', 'MA_TEMP', 'OA_CFM', 'OA_DMPR', 'OA_DMPR_DM', 'OA_TEMP', 'RA_CFM', 'RA_DMPR', 'RA_DMPR_DM', 'RA_TEMP', 'RF_CS', 'RF_SPD', 'RF_WAT', 'SA_CFM', 'SA_SP', 'SA_SPSPT', 'SA_TEMP', 'SF_CS', 'SF_SPD', 'SF_WAT', 'ZONE_TEMP_1', 'ZONE_TEMP_2', 'ZONE_TEMP_3', 'ZONE_TEMP_4', 'ZONE_TEMP_5']
2025-07-26 13:41:13 | INFO     | 🏗️ 模型信息:
2025-07-26 13:41:13 | INFO     |    模型类型: Model
2025-07-26 13:41:13 | INFO     |    总参数数量: 8,288,323
2025-07-26 13:41:13 | INFO     |    可训练参数: 8,288,323
2025-07-26 13:41:13 | INFO     |    模型大小估计: 31.62 MB
2025-07-26 13:41:13 | INFO     | 📊 数据集信息:
2025-07-26 13:41:13 | INFO     |    训练集大小: 4440
2025-07-26 13:41:13 | INFO     |    验证集大小: 1110
2025-07-26 13:41:18 | INFO     | 
================================================================================
2025-07-26 13:41:18 | INFO     | 📋 损失函数使用策略（遵循主流机器学习规范）:
2025-07-26 13:41:18 | INFO     |    🎯 训练阶段: 使用 ce 损失函数
2025-07-26 13:41:18 | INFO     |       → 目的：优化模型参数，解决特定问题（类别不平衡、相似性等）
2025-07-26 13:41:18 | INFO     |    📊 验证阶段: 使用标准交叉熵损失函数
2025-07-26 13:41:18 | INFO     |       → 目的：客观评估模型性能，便于不同方法比较
2025-07-26 13:41:18 | INFO     |    📈 最终报告: 基于标准交叉熵损失的指标
2025-07-26 13:41:18 | INFO     |       → 目的：提供可信、可比较的性能指标
2025-07-26 13:41:18 | INFO     | ================================================================================

2025-07-26 13:41:18 | INFO     | 🔄 梯度累积配置: 每2轮累积一次梯度
2025-07-26 13:41:18 | INFO     |    实际batch_size: 4
2025-07-26 13:41:18 | INFO     |    有效batch_size: 8
2025-07-26 13:42:32 | INFO     | Epoch 1:
2025-07-26 13:42:32 | INFO     |   训练指标:
2025-07-26 13:42:32 | INFO     |     损失(ce): 1.773496
2025-07-26 13:42:32 | INFO     |     准确率: 0.363514
2025-07-26 13:42:32 | INFO     |     学习率: 0.00010000
2025-07-26 13:42:32 | INFO     |   验证指标(标准CE):
2025-07-26 13:42:32 | INFO     |     损失: 0.887168
2025-07-26 13:42:32 | INFO     |     准确率: 0.688288
2025-07-26 13:42:32 | INFO     |     F1(macro): 0.666439
2025-07-26 13:42:32 | INFO     |     F1(weighted): 0.654144
2025-07-26 13:42:32 | INFO     |     精确率: 0.659767
2025-07-26 13:42:32 | INFO     |     召回率: 0.700092
2025-07-26 13:42:32 | INFO     |   学习率调度器: f1_based
2025-07-26 13:42:32 | INFO     | ------------------------------------------------------------
2025-07-26 13:42:32 | INFO     | Epoch   1 | Train: Loss=1.7735, Acc=0.3635 | Val: Loss=0.8872, Acc=0.6883, F1=0.6541 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:43:29 | INFO     | Epoch 2:
2025-07-26 13:43:29 | INFO     |   训练指标:
2025-07-26 13:43:29 | INFO     |     损失(ce): 0.717897
2025-07-26 13:43:29 | INFO     |     准确率: 0.722072
2025-07-26 13:43:29 | INFO     |     学习率: 0.00010000
2025-07-26 13:43:29 | INFO     |   验证指标(标准CE):
2025-07-26 13:43:29 | INFO     |     损失: 0.598011
2025-07-26 13:43:29 | INFO     |     准确率: 0.753153
2025-07-26 13:43:29 | INFO     |     F1(macro): 0.732621
2025-07-26 13:43:29 | INFO     |     F1(weighted): 0.707380
2025-07-26 13:43:29 | INFO     |     精确率: 0.726119
2025-07-26 13:43:29 | INFO     |     召回率: 0.780914
2025-07-26 13:43:29 | INFO     |   学习率调度器: f1_based
2025-07-26 13:43:29 | INFO     | ------------------------------------------------------------
2025-07-26 13:43:29 | INFO     | Epoch   2 | Train: Loss=0.7179, Acc=0.7221 | Val: Loss=0.5980, Acc=0.7532, F1=0.7074 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:44:25 | INFO     | Epoch 3:
2025-07-26 13:44:25 | INFO     |   训练指标:
2025-07-26 13:44:25 | INFO     |     损失(ce): 0.507320
2025-07-26 13:44:25 | INFO     |     准确率: 0.769144
2025-07-26 13:44:25 | INFO     |     学习率: 0.00010000
2025-07-26 13:44:25 | INFO     |   验证指标(标准CE):
2025-07-26 13:44:25 | INFO     |     损失: 0.444984
2025-07-26 13:44:25 | INFO     |     准确率: 0.762162
2025-07-26 13:44:25 | INFO     |     F1(macro): 0.742313
2025-07-26 13:44:25 | INFO     |     F1(weighted): 0.731328
2025-07-26 13:44:25 | INFO     |     精确率: 0.725014
2025-07-26 13:44:25 | INFO     |     召回率: 0.772582
2025-07-26 13:44:25 | INFO     |   学习率调度器: f1_based
2025-07-26 13:44:25 | INFO     | ------------------------------------------------------------
2025-07-26 13:44:25 | INFO     | Epoch   3 | Train: Loss=0.5073, Acc=0.7691 | Val: Loss=0.4450, Acc=0.7622, F1=0.7313 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:45:21 | INFO     | Epoch 4:
2025-07-26 13:45:21 | INFO     |   训练指标:
2025-07-26 13:45:21 | INFO     |     损失(ce): 0.438844
2025-07-26 13:45:21 | INFO     |     准确率: 0.797072
2025-07-26 13:45:21 | INFO     |     学习率: 0.00010000
2025-07-26 13:45:21 | INFO     |   验证指标(标准CE):
2025-07-26 13:45:21 | INFO     |     损失: 0.375087
2025-07-26 13:45:21 | INFO     |     准确率: 0.799099
2025-07-26 13:45:21 | INFO     |     F1(macro): 0.770999
2025-07-26 13:45:21 | INFO     |     F1(weighted): 0.759536
2025-07-26 13:45:21 | INFO     |     精确率: 0.812113
2025-07-26 13:45:21 | INFO     |     召回率: 0.804337
2025-07-26 13:45:21 | INFO     |   学习率调度器: f1_based
2025-07-26 13:45:21 | INFO     | ------------------------------------------------------------
2025-07-26 13:45:21 | INFO     | Epoch   4 | Train: Loss=0.4388, Acc=0.7971 | Val: Loss=0.3751, Acc=0.7991, F1=0.7595 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:46:16 | INFO     | Epoch 5:
2025-07-26 13:46:16 | INFO     |   训练指标:
2025-07-26 13:46:16 | INFO     |     损失(ce): 0.393825
2025-07-26 13:46:16 | INFO     |     准确率: 0.802477
2025-07-26 13:46:16 | INFO     |     学习率: 0.00010000
2025-07-26 13:46:16 | INFO     |   验证指标(标准CE):
2025-07-26 13:46:16 | INFO     |     损失: 0.375164
2025-07-26 13:46:16 | INFO     |     准确率: 0.794595
2025-07-26 13:46:16 | INFO     |     F1(macro): 0.766854
2025-07-26 13:46:16 | INFO     |     F1(weighted): 0.757051
2025-07-26 13:46:16 | INFO     |     精确率: 0.809711
2025-07-26 13:46:16 | INFO     |     召回率: 0.801213
2025-07-26 13:46:16 | INFO     |   学习率调度器: f1_based
2025-07-26 13:46:16 | INFO     | ------------------------------------------------------------
2025-07-26 13:46:16 | INFO     | Epoch   5 | Train: Loss=0.3938, Acc=0.8025 | Val: Loss=0.3752, Acc=0.7946, F1=0.7571 | LR=0.000100 
2025-07-26 13:47:11 | INFO     | Epoch 6:
2025-07-26 13:47:11 | INFO     |   训练指标:
2025-07-26 13:47:11 | INFO     |     损失(ce): 0.368015
2025-07-26 13:47:11 | INFO     |     准确率: 0.817117
2025-07-26 13:47:11 | INFO     |     学习率: 0.00010000
2025-07-26 13:47:11 | INFO     |   验证指标(标准CE):
2025-07-26 13:47:11 | INFO     |     损失: 0.298518
2025-07-26 13:47:11 | INFO     |     准确率: 0.826126
2025-07-26 13:47:11 | INFO     |     F1(macro): 0.812847
2025-07-26 13:47:11 | INFO     |     F1(weighted): 0.794954
2025-07-26 13:47:11 | INFO     |     精确率: 0.795534
2025-07-26 13:47:11 | INFO     |     召回率: 0.845516
2025-07-26 13:47:11 | INFO     |   学习率调度器: f1_based
2025-07-26 13:47:11 | INFO     | ------------------------------------------------------------
2025-07-26 13:47:11 | INFO     | Epoch   6 | Train: Loss=0.3680, Acc=0.8171 | Val: Loss=0.2985, Acc=0.8261, F1=0.7950 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:48:07 | INFO     | Epoch 7:
2025-07-26 13:48:07 | INFO     |   训练指标:
2025-07-26 13:48:07 | INFO     |     损失(ce): 0.338331
2025-07-26 13:48:07 | INFO     |     准确率: 0.832883
2025-07-26 13:48:07 | INFO     |     学习率: 0.00010000
2025-07-26 13:48:07 | INFO     |   验证指标(标准CE):
2025-07-26 13:48:07 | INFO     |     损失: 0.334854
2025-07-26 13:48:07 | INFO     |     准确率: 0.822523
2025-07-26 13:48:07 | INFO     |     F1(macro): 0.814712
2025-07-26 13:48:07 | INFO     |     F1(weighted): 0.796648
2025-07-26 13:48:07 | INFO     |     精确率: 0.829164
2025-07-26 13:48:07 | INFO     |     召回率: 0.845204
2025-07-26 13:48:07 | INFO     |   学习率调度器: f1_based
2025-07-26 13:48:07 | INFO     | ------------------------------------------------------------
2025-07-26 13:48:07 | INFO     | Epoch   7 | Train: Loss=0.3383, Acc=0.8329 | Val: Loss=0.3349, Acc=0.8225, F1=0.7966 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:49:03 | INFO     | Epoch 8:
2025-07-26 13:49:03 | INFO     |   训练指标:
2025-07-26 13:49:03 | INFO     |     损失(ce): 0.310295
2025-07-26 13:49:03 | INFO     |     准确率: 0.846847
2025-07-26 13:49:03 | INFO     |     学习率: 0.00010000
2025-07-26 13:49:03 | INFO     |   验证指标(标准CE):
2025-07-26 13:49:03 | INFO     |     损失: 0.336728
2025-07-26 13:49:03 | INFO     |     准确率: 0.845946
2025-07-26 13:49:03 | INFO     |     F1(macro): 0.834863
2025-07-26 13:49:03 | INFO     |     F1(weighted): 0.817959
2025-07-26 13:49:03 | INFO     |     精确率: 0.834728
2025-07-26 13:49:03 | INFO     |     召回率: 0.866644
2025-07-26 13:49:03 | INFO     |   学习率调度器: f1_based
2025-07-26 13:49:03 | INFO     | ------------------------------------------------------------
2025-07-26 13:49:03 | INFO     | Epoch   8 | Train: Loss=0.3103, Acc=0.8468 | Val: Loss=0.3367, Acc=0.8459, F1=0.8180 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:49:59 | INFO     | Epoch 9:
2025-07-26 13:49:59 | INFO     |   训练指标:
2025-07-26 13:49:59 | INFO     |     损失(ce): 0.290125
2025-07-26 13:49:59 | INFO     |     准确率: 0.850676
2025-07-26 13:49:59 | INFO     |     学习率: 0.00010000
2025-07-26 13:49:59 | INFO     |   验证指标(标准CE):
2025-07-26 13:49:59 | INFO     |     损失: 0.268350
2025-07-26 13:49:59 | INFO     |     准确率: 0.845045
2025-07-26 13:49:59 | INFO     |     F1(macro): 0.831755
2025-07-26 13:49:59 | INFO     |     F1(weighted): 0.814934
2025-07-26 13:49:59 | INFO     |     精确率: 0.822498
2025-07-26 13:49:59 | INFO     |     召回率: 0.864884
2025-07-26 13:49:59 | INFO     |   学习率调度器: f1_based
2025-07-26 13:49:59 | INFO     | ------------------------------------------------------------
2025-07-26 13:49:59 | INFO     | Epoch   9 | Train: Loss=0.2901, Acc=0.8507 | Val: Loss=0.2684, Acc=0.8450, F1=0.8149 | LR=0.000100 
2025-07-26 13:50:54 | INFO     | Epoch 10:
2025-07-26 13:50:54 | INFO     |   训练指标:
2025-07-26 13:50:54 | INFO     |     损失(ce): 0.271655
2025-07-26 13:50:54 | INFO     |     准确率: 0.859910
2025-07-26 13:50:54 | INFO     |     学习率: 0.00010000
2025-07-26 13:50:54 | INFO     |   验证指标(标准CE):
2025-07-26 13:50:54 | INFO     |     损失: 0.303620
2025-07-26 13:50:54 | INFO     |     准确率: 0.836036
2025-07-26 13:50:54 | INFO     |     F1(macro): 0.826913
2025-07-26 13:50:54 | INFO     |     F1(weighted): 0.809439
2025-07-26 13:50:54 | INFO     |     精确率: 0.834858
2025-07-26 13:50:54 | INFO     |     召回率: 0.857735
2025-07-26 13:50:54 | INFO     |   学习率调度器: f1_based
2025-07-26 13:50:54 | INFO     | ------------------------------------------------------------
2025-07-26 13:50:54 | INFO     | Epoch  10 | Train: Loss=0.2717, Acc=0.8599 | Val: Loss=0.3036, Acc=0.8360, F1=0.8094 | LR=0.000100 
2025-07-26 13:51:49 | INFO     | Epoch 11:
2025-07-26 13:51:49 | INFO     |   训练指标:
2025-07-26 13:51:49 | INFO     |     损失(ce): 0.256448
2025-07-26 13:51:49 | INFO     |     准确率: 0.859685
2025-07-26 13:51:49 | INFO     |     学习率: 0.00010000
2025-07-26 13:51:49 | INFO     |   验证指标(标准CE):
2025-07-26 13:51:49 | INFO     |     损失: 0.238505
2025-07-26 13:51:49 | INFO     |     准确率: 0.873874
2025-07-26 13:51:49 | INFO     |     F1(macro): 0.848325
2025-07-26 13:51:49 | INFO     |     F1(weighted): 0.845956
2025-07-26 13:51:49 | INFO     |     精确率: 0.847426
2025-07-26 13:51:49 | INFO     |     召回率: 0.871591
2025-07-26 13:51:49 | INFO     |   学习率调度器: f1_based
2025-07-26 13:51:49 | INFO     | ------------------------------------------------------------
2025-07-26 13:51:49 | INFO     | Epoch  11 | Train: Loss=0.2564, Acc=0.8597 | Val: Loss=0.2385, Acc=0.8739, F1=0.8460 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:52:45 | INFO     | Epoch 12:
2025-07-26 13:52:45 | INFO     |   训练指标:
2025-07-26 13:52:45 | INFO     |     损失(ce): 0.250631
2025-07-26 13:52:45 | INFO     |     准确率: 0.864189
2025-07-26 13:52:45 | INFO     |     学习率: 0.00010000
2025-07-26 13:52:45 | INFO     |   验证指标(标准CE):
2025-07-26 13:52:45 | INFO     |     损失: 0.215454
2025-07-26 13:52:45 | INFO     |     准确率: 0.867568
2025-07-26 13:52:45 | INFO     |     F1(macro): 0.878891
2025-07-26 13:52:45 | INFO     |     F1(weighted): 0.871991
2025-07-26 13:52:45 | INFO     |     精确率: 0.890246
2025-07-26 13:52:45 | INFO     |     召回率: 0.874119
2025-07-26 13:52:45 | INFO     |   学习率调度器: f1_based
2025-07-26 13:52:45 | INFO     | ------------------------------------------------------------
2025-07-26 13:52:45 | INFO     | Epoch  12 | Train: Loss=0.2506, Acc=0.8642 | Val: Loss=0.2155, Acc=0.8676, F1=0.8720 | LR=0.000100 🏆 [最佳模型]
2025-07-26 13:53:40 | INFO     | Epoch 13:
2025-07-26 13:53:40 | INFO     |   训练指标:
2025-07-26 13:53:40 | INFO     |     损失(ce): 0.226384
2025-07-26 13:53:40 | INFO     |     准确率: 0.870045
2025-07-26 13:53:40 | INFO     |     学习率: 0.00010000
2025-07-26 13:53:40 | INFO     |   验证指标(标准CE):
2025-07-26 13:53:40 | INFO     |     损失: 0.230105
2025-07-26 13:53:40 | INFO     |     准确率: 0.850450
2025-07-26 13:53:40 | INFO     |     F1(macro): 0.838096
2025-07-26 13:53:40 | INFO     |     F1(weighted): 0.821638
2025-07-26 13:53:40 | INFO     |     精确率: 0.836090
2025-07-26 13:53:40 | INFO     |     召回率: 0.870638
2025-07-26 13:53:40 | INFO     |   学习率调度器: f1_based
2025-07-26 13:53:40 | INFO     | ------------------------------------------------------------
2025-07-26 13:53:40 | INFO     | Epoch  13 | Train: Loss=0.2264, Acc=0.8700 | Val: Loss=0.2301, Acc=0.8505, F1=0.8216 | LR=0.000100 
2025-07-26 13:54:36 | INFO     | Epoch 14:
2025-07-26 13:54:36 | INFO     |   训练指标:
2025-07-26 13:54:36 | INFO     |     损失(ce): 0.223936
2025-07-26 13:54:36 | INFO     |     准确率: 0.868018
2025-07-26 13:54:36 | INFO     |     学习率: 0.00010000
2025-07-26 13:54:36 | INFO     |   验证指标(标准CE):
2025-07-26 13:54:36 | INFO     |     损失: 0.265913
2025-07-26 13:54:36 | INFO     |     准确率: 0.847748
2025-07-26 13:54:36 | INFO     |     F1(macro): 0.826740
2025-07-26 13:54:36 | INFO     |     F1(weighted): 0.809326
2025-07-26 13:54:36 | INFO     |     精确率: 0.803865
2025-07-26 13:54:36 | INFO     |     召回率: 0.863155
2025-07-26 13:54:36 | INFO     |   学习率调度器: f1_based
2025-07-26 13:54:36 | INFO     | ------------------------------------------------------------
2025-07-26 13:54:36 | INFO     | Epoch  14 | Train: Loss=0.2239, Acc=0.8680 | Val: Loss=0.2659, Acc=0.8477, F1=0.8093 | LR=0.000100 
2025-07-26 13:55:31 | INFO     | Epoch 15:
2025-07-26 13:55:31 | INFO     |   训练指标:
2025-07-26 13:55:31 | INFO     |     损失(ce): 0.219715
2025-07-26 13:55:31 | INFO     |     准确率: 0.877477
2025-07-26 13:55:31 | INFO     |     学习率: 0.00010000
2025-07-26 13:55:31 | INFO     |   验证指标(标准CE):
2025-07-26 13:55:31 | INFO     |     损失: 0.226462
2025-07-26 13:55:31 | INFO     |     准确率: 0.866667
2025-07-26 13:55:31 | INFO     |     F1(macro): 0.870161
2025-07-26 13:55:31 | INFO     |     F1(weighted): 0.865979
2025-07-26 13:55:31 | INFO     |     精确率: 0.879050
2025-07-26 13:55:31 | INFO     |     召回率: 0.869649
2025-07-26 13:55:31 | INFO     |   学习率调度器: f1_based
2025-07-26 13:55:31 | INFO     | ------------------------------------------------------------
2025-07-26 13:55:31 | INFO     | Epoch  15 | Train: Loss=0.2197, Acc=0.8775 | Val: Loss=0.2265, Acc=0.8667, F1=0.8660 | LR=0.000100 
2025-07-26 13:56:26 | INFO     | Epoch 16:
2025-07-26 13:56:26 | INFO     |   训练指标:
2025-07-26 13:56:26 | INFO     |     损失(ce): 0.224772
2025-07-26 13:56:26 | INFO     |     准确率: 0.869144
2025-07-26 13:56:26 | INFO     |     学习率: 0.00010000
2025-07-26 13:56:26 | INFO     |   验证指标(标准CE):
2025-07-26 13:56:26 | INFO     |     损失: 0.228233
2025-07-26 13:56:26 | INFO     |     准确率: 0.872973
2025-07-26 13:56:26 | INFO     |     F1(macro): 0.847541
2025-07-26 13:56:26 | INFO     |     F1(weighted): 0.845055
2025-07-26 13:56:26 | INFO     |     精确率: 0.846541
2025-07-26 13:56:26 | INFO     |     召回率: 0.870928
2025-07-26 13:56:26 | INFO     |   学习率调度器: f1_based
2025-07-26 13:56:26 | INFO     | ------------------------------------------------------------
2025-07-26 13:56:26 | INFO     | Epoch  16 | Train: Loss=0.2248, Acc=0.8691 | Val: Loss=0.2282, Acc=0.8730, F1=0.8451 | LR=0.000100 
2025-07-26 13:57:22 | INFO     | Epoch 17:
2025-07-26 13:57:22 | INFO     |   训练指标:
2025-07-26 13:57:22 | INFO     |     损失(ce): 0.213238
2025-07-26 13:57:22 | INFO     |     准确率: 0.868694
2025-07-26 13:57:22 | INFO     |     学习率: 0.00010000
2025-07-26 13:57:22 | INFO     |   验证指标(标准CE):
2025-07-26 13:57:22 | INFO     |     损失: 0.210834
2025-07-26 13:57:22 | INFO     |     准确率: 0.860360
2025-07-26 13:57:22 | INFO     |     F1(macro): 0.852879
2025-07-26 13:57:22 | INFO     |     F1(weighted): 0.839501
2025-07-26 13:57:22 | INFO     |     精确率: 0.864638
2025-07-26 13:57:22 | INFO     |     召回率: 0.873989
2025-07-26 13:57:22 | INFO     |   学习率调度器: f1_based
2025-07-26 13:57:22 | INFO     | ------------------------------------------------------------
2025-07-26 13:57:22 | INFO     | Epoch  17 | Train: Loss=0.2132, Acc=0.8687 | Val: Loss=0.2108, Acc=0.8604, F1=0.8395 | LR=0.000100 
2025-07-26 13:58:17 | INFO     | Epoch 18:
2025-07-26 13:58:17 | INFO     |   训练指标:
2025-07-26 13:58:17 | INFO     |     损失(ce): 0.209187
2025-07-26 13:58:17 | INFO     |     准确率: 0.870721
2025-07-26 13:58:17 | INFO     |     学习率: 0.00010000
2025-07-26 13:58:17 | INFO     |   验证指标(标准CE):
2025-07-26 13:58:17 | INFO     |     损失: 0.218040
2025-07-26 13:58:17 | INFO     |     准确率: 0.851351
2025-07-26 13:58:17 | INFO     |     F1(macro): 0.839196
2025-07-26 13:58:17 | INFO     |     F1(weighted): 0.822774
2025-07-26 13:58:17 | INFO     |     精确率: 0.836780
2025-07-26 13:58:17 | INFO     |     召回率: 0.871482
2025-07-26 13:58:17 | INFO     |   学习率调度器: f1_based
2025-07-26 13:58:17 | INFO     | ------------------------------------------------------------
2025-07-26 13:58:17 | INFO     | 🎯 学习率调整事件:
2025-07-26 13:58:17 | INFO     |   调度器类型: f1_based
2025-07-26 13:58:17 | INFO     |   学习率变化: 0.00010000 → 0.00005000
2025-07-26 13:58:17 | INFO     |   触发条件: F1分数 = 0.822774
2025-07-26 13:58:17 | INFO     |   变化幅度: -50.00%
2025-07-26 13:58:17 | INFO     | ------------------------------------------------------------
2025-07-26 13:58:17 | INFO     | Epoch  18 | Train: Loss=0.2092, Acc=0.8707 | Val: Loss=0.2180, Acc=0.8514, F1=0.8228 | LR=0.000050 
2025-07-26 13:59:12 | INFO     | Epoch 19:
2025-07-26 13:59:12 | INFO     |   训练指标:
2025-07-26 13:59:12 | INFO     |     损失(ce): 0.191713
2025-07-26 13:59:12 | INFO     |     准确率: 0.881081
2025-07-26 13:59:12 | INFO     |     学习率: 0.00005000
2025-07-26 13:59:12 | INFO     |   验证指标(标准CE):
2025-07-26 13:59:12 | INFO     |     损失: 0.204925
2025-07-26 13:59:12 | INFO     |     准确率: 0.877477
2025-07-26 13:59:12 | INFO     |     F1(macro): 0.846515
2025-07-26 13:59:12 | INFO     |     F1(weighted): 0.843685
2025-07-26 13:59:12 | INFO     |     精确率: 0.825488
2025-07-26 13:59:12 | INFO     |     召回率: 0.876079
2025-07-26 13:59:12 | INFO     |   学习率调度器: f1_based
2025-07-26 13:59:12 | INFO     | ------------------------------------------------------------
2025-07-26 13:59:12 | INFO     | Epoch  19 | Train: Loss=0.1917, Acc=0.8811 | Val: Loss=0.2049, Acc=0.8775, F1=0.8437 | LR=0.000050 
2025-07-26 14:00:07 | INFO     | Epoch 20:
2025-07-26 14:00:07 | INFO     |   训练指标:
2025-07-26 14:00:07 | INFO     |     损失(ce): 0.186002
2025-07-26 14:00:07 | INFO     |     准确率: 0.885811
2025-07-26 14:00:07 | INFO     |     学习率: 0.00005000
2025-07-26 14:00:07 | INFO     |   验证指标(标准CE):
2025-07-26 14:00:07 | INFO     |     损失: 0.203244
2025-07-26 14:00:07 | INFO     |     准确率: 0.847748
2025-07-26 14:00:07 | INFO     |     F1(macro): 0.850814
2025-07-26 14:00:07 | INFO     |     F1(weighted): 0.837316
2025-07-26 14:00:07 | INFO     |     精确率: 0.872571
2025-07-26 14:00:07 | INFO     |     召回率: 0.865037
2025-07-26 14:00:07 | INFO     |   学习率调度器: f1_based
2025-07-26 14:00:07 | INFO     | ------------------------------------------------------------
2025-07-26 14:00:07 | INFO     | Epoch  20 | Train: Loss=0.1860, Acc=0.8858 | Val: Loss=0.2032, Acc=0.8477, F1=0.8373 | LR=0.000050 
2025-07-26 14:01:03 | INFO     | Epoch 21:
2025-07-26 14:01:03 | INFO     |   训练指标:
2025-07-26 14:01:03 | INFO     |     损失(ce): 0.185440
2025-07-26 14:01:03 | INFO     |     准确率: 0.882883
2025-07-26 14:01:03 | INFO     |     学习率: 0.00005000
2025-07-26 14:01:03 | INFO     |   验证指标(标准CE):
2025-07-26 14:01:03 | INFO     |     损失: 0.204006
2025-07-26 14:01:03 | INFO     |     准确率: 0.880180
2025-07-26 14:01:03 | INFO     |     F1(macro): 0.854602
2025-07-26 14:01:03 | INFO     |     F1(weighted): 0.851507
2025-07-26 14:01:03 | INFO     |     精确率: 0.884487
2025-07-26 14:01:03 | INFO     |     召回率: 0.879082
2025-07-26 14:01:03 | INFO     |   学习率调度器: f1_based
2025-07-26 14:01:03 | INFO     | ------------------------------------------------------------
2025-07-26 14:01:03 | INFO     | Epoch  21 | Train: Loss=0.1854, Acc=0.8829 | Val: Loss=0.2040, Acc=0.8802, F1=0.8515 | LR=0.000050 
2025-07-26 14:01:58 | INFO     | Epoch 22:
2025-07-26 14:01:58 | INFO     |   训练指标:
2025-07-26 14:01:58 | INFO     |     损失(ce): 0.186701
2025-07-26 14:01:58 | INFO     |     准确率: 0.876126
2025-07-26 14:01:58 | INFO     |     学习率: 0.00005000
2025-07-26 14:01:58 | INFO     |   验证指标(标准CE):
2025-07-26 14:01:58 | INFO     |     损失: 0.201793
2025-07-26 14:01:58 | INFO     |     准确率: 0.878378
2025-07-26 14:01:58 | INFO     |     F1(macro): 0.852061
2025-07-26 14:01:58 | INFO     |     F1(weighted): 0.850005
2025-07-26 14:01:58 | INFO     |     精确率: 0.849057
2025-07-26 14:01:58 | INFO     |     召回率: 0.875806
2025-07-26 14:01:58 | INFO     |   学习率调度器: f1_based
2025-07-26 14:01:58 | INFO     | ------------------------------------------------------------
2025-07-26 14:01:58 | INFO     | Epoch  22 | Train: Loss=0.1867, Acc=0.8761 | Val: Loss=0.2018, Acc=0.8784, F1=0.8500 | LR=0.000050 
2025-07-26 14:02:53 | INFO     | Epoch 23:
2025-07-26 14:02:53 | INFO     |   训练指标:
2025-07-26 14:02:53 | INFO     |     损失(ce): 0.191771
2025-07-26 14:02:53 | INFO     |     准确率: 0.877477
2025-07-26 14:02:53 | INFO     |     学习率: 0.00005000
2025-07-26 14:02:53 | INFO     |   验证指标(标准CE):
2025-07-26 14:02:53 | INFO     |     损失: 0.201684
2025-07-26 14:02:53 | INFO     |     准确率: 0.870270
2025-07-26 14:02:53 | INFO     |     F1(macro): 0.871642
2025-07-26 14:02:53 | INFO     |     F1(weighted): 0.868016
2025-07-26 14:02:53 | INFO     |     精确率: 0.879942
2025-07-26 14:02:53 | INFO     |     召回率: 0.872509
2025-07-26 14:02:53 | INFO     |   学习率调度器: f1_based
2025-07-26 14:02:53 | INFO     | ------------------------------------------------------------
2025-07-26 14:02:53 | INFO     | Epoch  23 | Train: Loss=0.1918, Acc=0.8775 | Val: Loss=0.2017, Acc=0.8703, F1=0.8680 | LR=0.000050 
2025-07-26 14:03:49 | INFO     | Epoch 24:
2025-07-26 14:03:49 | INFO     |   训练指标:
2025-07-26 14:03:49 | INFO     |     损失(ce): 0.186704
2025-07-26 14:03:49 | INFO     |     准确率: 0.880405
2025-07-26 14:03:49 | INFO     |     学习率: 0.00005000
2025-07-26 14:03:49 | INFO     |   验证指标(标准CE):
2025-07-26 14:03:49 | INFO     |     损失: 0.210885
2025-07-26 14:03:49 | INFO     |     准确率: 0.854054
2025-07-26 14:03:49 | INFO     |     F1(macro): 0.841709
2025-07-26 14:03:49 | INFO     |     F1(weighted): 0.825277
2025-07-26 14:03:49 | INFO     |     精确率: 0.839326
2025-07-26 14:03:49 | INFO     |     召回率: 0.874091
2025-07-26 14:03:49 | INFO     |   学习率调度器: f1_based
2025-07-26 14:03:49 | INFO     | ------------------------------------------------------------
2025-07-26 14:03:49 | INFO     | Epoch  24 | Train: Loss=0.1867, Acc=0.8804 | Val: Loss=0.2109, Acc=0.8541, F1=0.8253 | LR=0.000050 
2025-07-26 14:04:44 | INFO     | Epoch 25:
2025-07-26 14:04:44 | INFO     |   训练指标:
2025-07-26 14:04:44 | INFO     |     损失(ce): 0.188596
2025-07-26 14:04:44 | INFO     |     准确率: 0.881982
2025-07-26 14:04:44 | INFO     |     学习率: 0.00005000
2025-07-26 14:04:44 | INFO     |   验证指标(标准CE):
2025-07-26 14:04:44 | INFO     |     损失: 0.215009
2025-07-26 14:04:44 | INFO     |     准确率: 0.854955
2025-07-26 14:04:44 | INFO     |     F1(macro): 0.842318
2025-07-26 14:04:44 | INFO     |     F1(weighted): 0.825874
2025-07-26 14:04:44 | INFO     |     精确率: 0.839474
2025-07-26 14:04:44 | INFO     |     召回率: 0.875000
2025-07-26 14:04:44 | INFO     |   学习率调度器: f1_based
2025-07-26 14:04:44 | INFO     | ------------------------------------------------------------
2025-07-26 14:04:44 | INFO     | Epoch  25 | Train: Loss=0.1886, Acc=0.8820 | Val: Loss=0.2150, Acc=0.8550, F1=0.8259 | LR=0.000050 
2025-07-26 14:05:39 | INFO     | Epoch 26:
2025-07-26 14:05:39 | INFO     |   训练指标:
2025-07-26 14:05:39 | INFO     |     损失(ce): 0.188494
2025-07-26 14:05:39 | INFO     |     准确率: 0.880180
2025-07-26 14:05:39 | INFO     |     学习率: 0.00005000
2025-07-26 14:05:39 | INFO     |   验证指标(标准CE):
2025-07-26 14:05:39 | INFO     |     损失: 0.203353
2025-07-26 14:05:39 | INFO     |     准确率: 0.854955
2025-07-26 14:05:39 | INFO     |     F1(macro): 0.842318
2025-07-26 14:05:39 | INFO     |     F1(weighted): 0.825874
2025-07-26 14:05:39 | INFO     |     精确率: 0.839474
2025-07-26 14:05:39 | INFO     |     召回率: 0.875000
2025-07-26 14:05:39 | INFO     |   学习率调度器: f1_based
2025-07-26 14:05:39 | INFO     | ------------------------------------------------------------
2025-07-26 14:05:39 | INFO     | 🎯 学习率调整事件:
2025-07-26 14:05:39 | INFO     |   调度器类型: f1_based
2025-07-26 14:05:39 | INFO     |   学习率变化: 0.00005000 → 0.00002500
2025-07-26 14:05:39 | INFO     |   触发条件: F1分数 = 0.825874
2025-07-26 14:05:39 | INFO     |   变化幅度: -50.00%
2025-07-26 14:05:39 | INFO     | ------------------------------------------------------------
2025-07-26 14:05:39 | INFO     | Epoch  26 | Train: Loss=0.1885, Acc=0.8802 | Val: Loss=0.2034, Acc=0.8550, F1=0.8259 | LR=0.000025 
2025-07-26 14:06:34 | INFO     | Epoch 27:
2025-07-26 14:06:34 | INFO     |   训练指标:
2025-07-26 14:06:34 | INFO     |     损失(ce): 0.179108
2025-07-26 14:06:34 | INFO     |     准确率: 0.881982
2025-07-26 14:06:34 | INFO     |     学习率: 0.00002500
2025-07-26 14:06:34 | INFO     |   验证指标(标准CE):
2025-07-26 14:06:34 | INFO     |     损失: 0.198159
2025-07-26 14:06:34 | INFO     |     准确率: 0.878378
2025-07-26 14:06:34 | INFO     |     F1(macro): 0.852061
2025-07-26 14:06:34 | INFO     |     F1(weighted): 0.850005
2025-07-26 14:06:34 | INFO     |     精确率: 0.849057
2025-07-26 14:06:34 | INFO     |     召回率: 0.875806
2025-07-26 14:06:34 | INFO     |   学习率调度器: f1_based
2025-07-26 14:06:34 | INFO     | ------------------------------------------------------------
2025-07-26 14:06:34 | INFO     | Epoch  27 | Train: Loss=0.1791, Acc=0.8820 | Val: Loss=0.1982, Acc=0.8784, F1=0.8500 | LR=0.000025 
2025-07-26 14:06:34 | INFO     | ⏹️ 早停触发，在第 27 轮停止训练
2025-07-26 14:06:38 | INFO     | 训练历史已保存到: ./result/0726_1341_DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat/training_history.csv
2025-07-26 14:06:38 | INFO     | 
====================================================================================================
2025-07-26 14:06:38 | INFO     | 🎉 训练完成总结:
2025-07-26 14:06:38 | INFO     |   训练损失函数: ce
2025-07-26 14:06:38 | INFO     |   验证损失函数: 标准交叉熵（遵循主流ML规范）
2025-07-26 14:06:38 | INFO     |   训练过程最佳验证准确率: 0.8802
2025-07-26 14:06:38 | INFO     |   训练过程最佳验证F1(macro): 0.8789
2025-07-26 14:06:38 | INFO     |   训练过程最佳验证F1(weighted): 0.8720
2025-07-26 14:06:38 | INFO     |   训练轮数: 27
2025-07-26 14:06:38 | INFO     | --------------------------------------------------
2025-07-26 14:06:38 | INFO     | 📊 最佳模型真实性能指标（基于标准交叉熵损失）:
2025-07-26 14:06:38 | INFO     |   验证损失(标准CE): 0.2138
2025-07-26 14:06:38 | INFO     |   验证准确率: 0.8676
2025-07-26 14:06:38 | INFO     |   验证F1(macro): 0.8789
2025-07-26 14:06:38 | INFO     |   验证F1(weighted): 0.8720
2025-07-26 14:06:38 | INFO     |   验证精确率: 0.8902
2025-07-26 14:06:38 | INFO     |   验证召回率: 0.8741
2025-07-26 14:06:38 | INFO     | ====================================================================================================
2025-07-26 14:06:40 | INFO     | ================================================================================
2025-07-26 14:06:40 | INFO     | 实验日志结束: DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat
2025-07-26 14:06:40 | INFO     | 结束时间: 2025-07-26 14:06:40
2025-07-26 14:06:40 | INFO     | ================================================================================
