2025-07-26 15:22:56 | INFO     | ================================================================================
2025-07-26 15:22:56 | INFO     | 实验日志开始: DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat
2025-07-26 15:22:56 | INFO     | 日志文件: ./result/0726_1522_DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat/training.log
2025-07-26 15:22:56 | INFO     | 开始时间: 2025-07-26 15:22:56
2025-07-26 15:22:56 | INFO     | ================================================================================
2025-07-26 15:22:56 | INFO     | ⚙️ 实验配置:
2025-07-26 15:22:56 | INFO     |    task_name: classification
2025-07-26 15:22:56 | INFO     |    is_training: 1
2025-07-26 15:22:56 | INFO     |    model_id: test
2025-07-26 15:22:56 | INFO     |    model: DualGAFNet
2025-07-26 15:22:56 | INFO     |    data: DualGAF
2025-07-26 15:22:56 | INFO     |    root_path: ./dataset/SAHU/direct_5_working
2025-07-26 15:22:56 | INFO     |    step: 96
2025-07-26 15:22:56 | INFO     |    checkpoints: ./checkpoints/
2025-07-26 15:22:56 | INFO     |    num_class: 8
2025-07-26 15:22:56 | INFO     |    result_path: ./result/
2025-07-26 15:22:56 | INFO     |    test_size: 0.2
2025-07-26 15:22:56 | INFO     |    rows: None
2025-07-26 15:22:56 | INFO     |    seq_len: 96
2025-07-26 15:22:56 | INFO     |    enc_in: 26
2025-07-26 15:22:56 | INFO     |    d_model: 512
2025-07-26 15:22:56 | INFO     |    n_heads: 8
2025-07-26 15:22:56 | INFO     |    e_layers: 2
2025-07-26 15:22:56 | INFO     |    d_layers: 1
2025-07-26 15:22:56 | INFO     |    d_ff: 2048
2025-07-26 15:22:56 | INFO     |    moving_avg: 25
2025-07-26 15:22:56 | INFO     |    factor: 1
2025-07-26 15:22:56 | INFO     |    distil: True
2025-07-26 15:22:56 | INFO     |    dropout: 0.1
2025-07-26 15:22:56 | INFO     |    embed: timeF
2025-07-26 15:22:56 | INFO     |    activation: gelu
2025-07-26 15:22:56 | INFO     |    use_norm: 1
2025-07-26 15:22:56 | INFO     |    gaf_method: summation
2025-07-26 15:22:56 | INFO     |    feature_dim: 128
2025-07-26 15:22:56 | INFO     |    data_type_method: uint8
2025-07-26 15:22:56 | INFO     |    use_attention: True
2025-07-26 15:22:56 | INFO     |    hidden_dim: 64
2025-07-26 15:22:56 | INFO     |    sample_size: 1000
2025-07-26 15:22:56 | INFO     |    channel_groups: None
2025-07-26 15:22:56 | INFO     |    hvac_groups: None
2025-07-26 15:22:56 | INFO     |    extractor_type: dilated
2025-07-26 15:22:56 | INFO     |    fusion_type: concat
2025-07-26 15:22:56 | INFO     |    attention_type: channel
2025-07-26 15:22:56 | INFO     |    classifier_type: mlp
2025-07-26 15:22:56 | INFO     |    use_statistical_features: True
2025-07-26 15:22:56 | INFO     |    stat_type: basic
2025-07-26 15:22:56 | INFO     |    multimodal_fusion_strategy: concat
2025-07-26 15:22:56 | INFO     |    use_signal_level_stats: False
2025-07-26 15:22:56 | INFO     |    signal_stat_type: comprehensive
2025-07-26 15:22:56 | INFO     |    signal_stat_fusion_strategy: concat_project
2025-07-26 15:22:56 | INFO     |    signal_stat_feature_dim: 32
2025-07-26 15:22:56 | INFO     |    use_diff_branch: True
2025-07-26 15:22:56 | INFO     |    ablation_mode: none
2025-07-26 15:22:56 | INFO     |    backbone_type: resnet18
2025-07-26 15:22:56 | INFO     |    use_sum_branch: True
2025-07-26 15:22:56 | INFO     |    num_workers: 0
2025-07-26 15:22:56 | INFO     |    cuda_debug: False
2025-07-26 15:22:56 | INFO     |    gpu_memory_fraction: 0.9
2025-07-26 15:22:56 | INFO     |    safe_mode: True
2025-07-26 15:22:56 | INFO     |    drop_last_batch: True
2025-07-26 15:22:56 | INFO     |    itr: 1
2025-07-26 15:22:56 | INFO     |    train_epochs: 300
2025-07-26 15:22:56 | INFO     |    batch_size: 4
2025-07-26 15:22:56 | INFO     |    patience: 15
2025-07-26 15:22:56 | INFO     |    learning_rate: 0.0001
2025-07-26 15:22:56 | INFO     |    des: dilated+concat+channel+mlp
2025-07-26 15:22:56 | INFO     |    loss: MSE
2025-07-26 15:22:56 | INFO     |    lradj: type1
2025-07-26 15:22:56 | INFO     |    lr_scheduler_type: f1_based
2025-07-26 15:22:56 | INFO     |    lr_loss_weight: 0.3
2025-07-26 15:22:56 | INFO     |    lr_f1_weight: 0.7
2025-07-26 15:22:56 | INFO     |    use_amp: False
2025-07-26 15:22:56 | INFO     |    gradient_accumulation_steps: 2
2025-07-26 15:22:56 | INFO     |    enable_auto_gradient_accumulation: True
2025-07-26 15:22:56 | INFO     |    loss_type: ce
2025-07-26 15:22:56 | INFO     |    label_smoothing: 0.1
2025-07-26 15:22:56 | INFO     |    focal_alpha: 1.0
2025-07-26 15:22:56 | INFO     |    focal_gamma: 2.0
2025-07-26 15:22:56 | INFO     |    confidence_penalty_beta: 0.1
2025-07-26 15:22:56 | INFO     |    use_timm_loss: True
2025-07-26 15:22:56 | INFO     |    adaptive_initial_smoothing: 0.2
2025-07-26 15:22:56 | INFO     |    adaptive_final_smoothing: 0.05
2025-07-26 15:22:56 | INFO     |    adaptive_decay_epochs: 30
2025-07-26 15:22:56 | INFO     |    enable_class_weights: False
2025-07-26 15:22:56 | INFO     |    class_weights: None
2025-07-26 15:22:56 | INFO     |    loss_preset: None
2025-07-26 15:22:56 | INFO     |    n_jobs: 1
2025-07-26 15:22:56 | INFO     |    use_multiprocessing: False
2025-07-26 15:22:56 | INFO     |    chunk_size: 800
2025-07-26 15:22:56 | INFO     |    disable_parallel: True
2025-07-26 15:22:56 | INFO     |    use_shared_memory: False
2025-07-26 15:22:56 | INFO     |    disable_shared_memory: False
2025-07-26 15:22:56 | INFO     |    use_gpu: True
2025-07-26 15:22:56 | INFO     |    gpu: 0
2025-07-26 15:22:56 | INFO     |    gpu_type: cuda
2025-07-26 15:22:56 | INFO     |    use_multi_gpu: False
2025-07-26 15:22:56 | INFO     |    devices: 0,1,2,3
2025-07-26 15:22:56 | INFO     |    device: cuda:0
2025-07-26 15:22:56 | INFO     |    feature_columns: ['CHWC_VLV', 'CHWC_VLV_DM', 'MA_TEMP', 'OA_CFM', 'OA_DMPR', 'OA_DMPR_DM', 'OA_TEMP', 'RA_CFM', 'RA_DMPR', 'RA_DMPR_DM', 'RA_TEMP', 'RF_CS', 'RF_SPD', 'RF_WAT', 'SA_CFM', 'SA_SP', 'SA_SPSPT', 'SA_TEMP', 'SF_CS', 'SF_SPD', 'SF_WAT', 'ZONE_TEMP_1', 'ZONE_TEMP_2', 'ZONE_TEMP_3', 'ZONE_TEMP_4', 'ZONE_TEMP_5']
2025-07-26 15:22:56 | INFO     | 🏗️ 模型信息:
2025-07-26 15:22:56 | INFO     |    模型类型: Model
2025-07-26 15:22:56 | INFO     |    总参数数量: 8,288,065
2025-07-26 15:22:56 | INFO     |    可训练参数: 8,288,065
2025-07-26 15:22:56 | INFO     |    模型大小估计: 31.62 MB
2025-07-26 15:22:56 | INFO     | 📊 数据集信息:
2025-07-26 15:22:56 | INFO     |    训练集大小: 3552
2025-07-26 15:22:56 | INFO     |    验证集大小: 888
2025-07-26 15:22:56 | INFO     | 
================================================================================
2025-07-26 15:22:56 | INFO     | 📋 损失函数使用策略（遵循主流机器学习规范）:
2025-07-26 15:22:56 | INFO     |    🎯 训练阶段: 使用 ce 损失函数
2025-07-26 15:22:56 | INFO     |       → 目的：优化模型参数，解决特定问题（类别不平衡、相似性等）
2025-07-26 15:22:56 | INFO     |    📊 验证阶段: 使用标准交叉熵损失函数
2025-07-26 15:22:56 | INFO     |       → 目的：客观评估模型性能，便于不同方法比较
2025-07-26 15:22:56 | INFO     |    📈 最终报告: 基于标准交叉熵损失的指标
2025-07-26 15:22:56 | INFO     |       → 目的：提供可信、可比较的性能指标
2025-07-26 15:22:56 | INFO     | ================================================================================

2025-07-26 15:22:56 | INFO     | 🔄 梯度累积配置: 每2轮累积一次梯度
2025-07-26 15:22:56 | INFO     |    实际batch_size: 4
2025-07-26 15:22:56 | INFO     |    有效batch_size: 8
2025-07-26 15:23:41 | INFO     | Epoch 1:
2025-07-26 15:23:41 | INFO     |   训练指标:
2025-07-26 15:23:41 | INFO     |     损失(ce): 1.602798
2025-07-26 15:23:41 | INFO     |     准确率: 0.395270
2025-07-26 15:23:41 | INFO     |     学习率: 0.00010000
2025-07-26 15:23:41 | INFO     |   验证指标(标准CE):
2025-07-26 15:23:41 | INFO     |     损失: 0.858863
2025-07-26 15:23:41 | INFO     |     准确率: 0.768018
2025-07-26 15:23:41 | INFO     |     F1(macro): 0.774333
2025-07-26 15:23:41 | INFO     |     F1(weighted): 0.764974
2025-07-26 15:23:41 | INFO     |     精确率: 0.804612
2025-07-26 15:23:41 | INFO     |     召回率: 0.771578
2025-07-26 15:23:41 | INFO     |   学习率调度器: f1_based
2025-07-26 15:23:41 | INFO     | ------------------------------------------------------------
2025-07-26 15:23:41 | INFO     | Epoch   1 | Train: Loss=1.6028, Acc=0.3953 | Val: Loss=0.8589, Acc=0.7680, F1=0.7650 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:24:26 | INFO     | Epoch 2:
2025-07-26 15:24:26 | INFO     |   训练指标:
2025-07-26 15:24:26 | INFO     |     损失(ce): 0.549959
2025-07-26 15:24:26 | INFO     |     准确率: 0.807995
2025-07-26 15:24:26 | INFO     |     学习率: 0.00010000
2025-07-26 15:24:26 | INFO     |   验证指标(标准CE):
2025-07-26 15:24:26 | INFO     |     损失: 0.158721
2025-07-26 15:24:26 | INFO     |     准确率: 0.949324
2025-07-26 15:24:26 | INFO     |     F1(macro): 0.951359
2025-07-26 15:24:26 | INFO     |     F1(weighted): 0.948934
2025-07-26 15:24:26 | INFO     |     精确率: 0.957082
2025-07-26 15:24:26 | INFO     |     召回率: 0.949196
2025-07-26 15:24:26 | INFO     |   学习率调度器: f1_based
2025-07-26 15:24:26 | INFO     | ------------------------------------------------------------
2025-07-26 15:24:26 | INFO     | Epoch   2 | Train: Loss=0.5500, Acc=0.8080 | Val: Loss=0.1587, Acc=0.9493, F1=0.9489 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:25:11 | INFO     | Epoch 3:
2025-07-26 15:25:11 | INFO     |   训练指标:
2025-07-26 15:25:11 | INFO     |     损失(ce): 0.153517
2025-07-26 15:25:11 | INFO     |     准确率: 0.948198
2025-07-26 15:25:11 | INFO     |     学习率: 0.00010000
2025-07-26 15:25:11 | INFO     |   验证指标(标准CE):
2025-07-26 15:25:11 | INFO     |     损失: 0.052919
2025-07-26 15:25:11 | INFO     |     准确率: 0.984234
2025-07-26 15:25:11 | INFO     |     F1(macro): 0.985914
2025-07-26 15:25:11 | INFO     |     F1(weighted): 0.984222
2025-07-26 15:25:11 | INFO     |     精确率: 0.986775
2025-07-26 15:25:11 | INFO     |     召回率: 0.985363
2025-07-26 15:25:11 | INFO     |   学习率调度器: f1_based
2025-07-26 15:25:11 | INFO     | ------------------------------------------------------------
2025-07-26 15:25:11 | INFO     | Epoch   3 | Train: Loss=0.1535, Acc=0.9482 | Val: Loss=0.0529, Acc=0.9842, F1=0.9842 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:25:56 | INFO     | Epoch 4:
2025-07-26 15:25:56 | INFO     |   训练指标:
2025-07-26 15:25:56 | INFO     |     损失(ce): 0.061474
2025-07-26 15:25:56 | INFO     |     准确率: 0.981700
2025-07-26 15:25:56 | INFO     |     学习率: 0.00010000
2025-07-26 15:25:56 | INFO     |   验证指标(标准CE):
2025-07-26 15:25:56 | INFO     |     损失: 0.041159
2025-07-26 15:25:56 | INFO     |     准确率: 0.993243
2025-07-26 15:25:56 | INFO     |     F1(macro): 0.993935
2025-07-26 15:25:56 | INFO     |     F1(weighted): 0.993249
2025-07-26 15:25:56 | INFO     |     精确率: 0.993773
2025-07-26 15:25:56 | INFO     |     召回率: 0.994204
2025-07-26 15:25:56 | INFO     |   学习率调度器: f1_based
2025-07-26 15:25:56 | INFO     | ------------------------------------------------------------
2025-07-26 15:25:56 | INFO     | Epoch   4 | Train: Loss=0.0615, Acc=0.9817 | Val: Loss=0.0412, Acc=0.9932, F1=0.9932 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:26:41 | INFO     | Epoch 5:
2025-07-26 15:26:41 | INFO     |   训练指标:
2025-07-26 15:26:41 | INFO     |     损失(ce): 0.038043
2025-07-26 15:26:41 | INFO     |     准确率: 0.988457
2025-07-26 15:26:41 | INFO     |     学习率: 0.00010000
2025-07-26 15:26:41 | INFO     |   验证指标(标准CE):
2025-07-26 15:26:41 | INFO     |     损失: 0.022361
2025-07-26 15:26:41 | INFO     |     准确率: 0.996622
2025-07-26 15:26:41 | INFO     |     F1(macro): 0.997023
2025-07-26 15:26:41 | INFO     |     F1(weighted): 0.996625
2025-07-26 15:26:41 | INFO     |     精确率: 0.996795
2025-07-26 15:26:41 | INFO     |     召回率: 0.997321
2025-07-26 15:26:41 | INFO     |   学习率调度器: f1_based
2025-07-26 15:26:41 | INFO     | ------------------------------------------------------------
2025-07-26 15:26:41 | INFO     | Epoch   5 | Train: Loss=0.0380, Acc=0.9885 | Val: Loss=0.0224, Acc=0.9966, F1=0.9966 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:27:25 | INFO     | Epoch 6:
2025-07-26 15:27:25 | INFO     |   训练指标:
2025-07-26 15:27:25 | INFO     |     损失(ce): 0.016878
2025-07-26 15:27:25 | INFO     |     准确率: 0.994369
2025-07-26 15:27:25 | INFO     |     学习率: 0.00010000
2025-07-26 15:27:25 | INFO     |   验证指标(标准CE):
2025-07-26 15:27:25 | INFO     |     损失: 0.023256
2025-07-26 15:27:25 | INFO     |     准确率: 0.992117
2025-07-26 15:27:25 | INFO     |     F1(macro): 0.992423
2025-07-26 15:27:25 | INFO     |     F1(weighted): 0.992119
2025-07-26 15:27:25 | INFO     |     精确率: 0.991865
2025-07-26 15:27:25 | INFO     |     召回率: 0.993139
2025-07-26 15:27:25 | INFO     |   学习率调度器: f1_based
2025-07-26 15:27:25 | INFO     | ------------------------------------------------------------
2025-07-26 15:27:25 | INFO     | Epoch   6 | Train: Loss=0.0169, Acc=0.9944 | Val: Loss=0.0233, Acc=0.9921, F1=0.9921 | LR=0.000100 
2025-07-26 15:28:10 | INFO     | Epoch 7:
2025-07-26 15:28:10 | INFO     |   训练指标:
2025-07-26 15:28:10 | INFO     |     损失(ce): 0.023336
2025-07-26 15:28:10 | INFO     |     准确率: 0.994932
2025-07-26 15:28:10 | INFO     |     学习率: 0.00010000
2025-07-26 15:28:10 | INFO     |   验证指标(标准CE):
2025-07-26 15:28:10 | INFO     |     损失: 0.008210
2025-07-26 15:28:10 | INFO     |     准确率: 0.997748
2025-07-26 15:28:10 | INFO     |     F1(macro): 0.998018
2025-07-26 15:28:10 | INFO     |     F1(weighted): 0.997745
2025-07-26 15:28:10 | INFO     |     精确率: 0.997845
2025-07-26 15:28:10 | INFO     |     召回率: 0.998214
2025-07-26 15:28:10 | INFO     |   学习率调度器: f1_based
2025-07-26 15:28:10 | INFO     | ------------------------------------------------------------
2025-07-26 15:28:10 | INFO     | Epoch   7 | Train: Loss=0.0233, Acc=0.9949 | Val: Loss=0.0082, Acc=0.9977, F1=0.9977 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:28:54 | INFO     | Epoch 8:
2025-07-26 15:28:54 | INFO     |   训练指标:
2025-07-26 15:28:54 | INFO     |     损失(ce): 0.016573
2025-07-26 15:28:54 | INFO     |     准确率: 0.994369
2025-07-26 15:28:54 | INFO     |     学习率: 0.00010000
2025-07-26 15:28:54 | INFO     |   验证指标(标准CE):
2025-07-26 15:28:54 | INFO     |     损失: 0.017979
2025-07-26 15:28:54 | INFO     |     准确率: 0.996622
2025-07-26 15:28:54 | INFO     |     F1(macro): 0.996936
2025-07-26 15:28:54 | INFO     |     F1(weighted): 0.996623
2025-07-26 15:28:54 | INFO     |     精确率: 0.996785
2025-07-26 15:28:54 | INFO     |     召回率: 0.997118
2025-07-26 15:28:54 | INFO     |   学习率调度器: f1_based
2025-07-26 15:28:54 | INFO     | ------------------------------------------------------------
2025-07-26 15:28:54 | INFO     | Epoch   8 | Train: Loss=0.0166, Acc=0.9944 | Val: Loss=0.0180, Acc=0.9966, F1=0.9966 | LR=0.000100 
2025-07-26 15:29:38 | INFO     | Epoch 9:
2025-07-26 15:29:38 | INFO     |   训练指标:
2025-07-26 15:29:38 | INFO     |     损失(ce): 0.010631
2025-07-26 15:29:38 | INFO     |     准确率: 0.997185
2025-07-26 15:29:38 | INFO     |     学习率: 0.00010000
2025-07-26 15:29:38 | INFO     |   验证指标(标准CE):
2025-07-26 15:29:38 | INFO     |     损失: 0.000579
2025-07-26 15:29:38 | INFO     |     准确率: 1.000000
2025-07-26 15:29:38 | INFO     |     F1(macro): 1.000000
2025-07-26 15:29:38 | INFO     |     F1(weighted): 1.000000
2025-07-26 15:29:38 | INFO     |     精确率: 1.000000
2025-07-26 15:29:38 | INFO     |     召回率: 1.000000
2025-07-26 15:29:38 | INFO     |   学习率调度器: f1_based
2025-07-26 15:29:38 | INFO     | ------------------------------------------------------------
2025-07-26 15:29:38 | INFO     | Epoch   9 | Train: Loss=0.0106, Acc=0.9972 | Val: Loss=0.0006, Acc=1.0000, F1=1.0000 | LR=0.000100 🏆 [最佳模型]
2025-07-26 15:29:39 | INFO     | ⏹️ 早停触发，在第 9 轮停止训练
2025-07-26 15:29:42 | INFO     | 训练历史已保存到: ./result/0726_1522_DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat/training_history.csv
2025-07-26 15:29:42 | INFO     | 
====================================================================================================
2025-07-26 15:29:42 | INFO     | 🎉 训练完成总结:
2025-07-26 15:29:42 | INFO     |   训练损失函数: ce
2025-07-26 15:29:42 | INFO     |   验证损失函数: 标准交叉熵（遵循主流ML规范）
2025-07-26 15:29:42 | INFO     |   训练过程最佳验证准确率: 1.0000
2025-07-26 15:29:42 | INFO     |   训练过程最佳验证F1(macro): 1.0000
2025-07-26 15:29:42 | INFO     |   训练过程最佳验证F1(weighted): 1.0000
2025-07-26 15:29:42 | INFO     |   训练轮数: 9
2025-07-26 15:29:42 | INFO     | --------------------------------------------------
2025-07-26 15:29:42 | INFO     | 📊 最佳模型真实性能指标（基于标准交叉熵损失）:
2025-07-26 15:29:42 | INFO     |   验证损失(标准CE): 0.0006
2025-07-26 15:29:42 | INFO     |   验证准确率: 1.0000
2025-07-26 15:29:42 | INFO     |   验证F1(macro): 1.0000
2025-07-26 15:29:42 | INFO     |   验证F1(weighted): 1.0000
2025-07-26 15:29:42 | INFO     |   验证精确率: 1.0000
2025-07-26 15:29:42 | INFO     |   验证召回率: 1.0000
2025-07-26 15:29:42 | INFO     | ====================================================================================================
2025-07-26 15:29:44 | INFO     | ================================================================================
2025-07-26 15:29:44 | INFO     | 实验日志结束: DualGAF_DualGAFNet_dilated+concat+channel+mlp_sl96_step96_fd128_extractor-dilated_gaf-concat_attention-channel_classifier-mlp_stat-basic_fusion-concat
2025-07-26 15:29:44 | INFO     | 结束时间: 2025-07-26 15:29:44
2025-07-26 15:29:44 | INFO     | ================================================================================
