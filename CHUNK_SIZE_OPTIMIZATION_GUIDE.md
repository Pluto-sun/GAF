# å—å¤§å°ä¼˜åŒ–æµ‹è¯•æŒ‡å—

## ğŸ“– æ¦‚è¿°

è¿™å¥—æµ‹è¯•è„šæœ¬ç”¨äºä¼˜åŒ–GAFè®¡ç®—å’Œæ•°æ®ç±»å‹è½¬æ¢çš„å—å¤§å°é…ç½®ï¼Œé€šè¿‡æµ‹è¯•ä¸åŒçš„å—å¤§å°å’Œå¤„ç†æ¨¡å¼ï¼ˆæ ‡å‡†å¤šè¿›ç¨‹ vs å…±äº«å†…å­˜ï¼‰ï¼Œæ‰¾å‡ºæœ€é€‚åˆå½“å‰æœåŠ¡å™¨çš„æœ€ä¼˜é…ç½®ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¿«é€ŸéªŒè¯æµ‹è¯•
```bash
# è¿è¡Œå¿«é€Ÿæµ‹è¯•ï¼ˆ1000æ ·æœ¬ï¼Œç”¨äºéªŒè¯åŠŸèƒ½ï¼‰
python test_chunk_size_quick.py
```

### 2. å®Œæ•´æ€§èƒ½æµ‹è¯•  
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•ï¼ˆ5000æ ·æœ¬ï¼Œè·å¾—å‡†ç¡®çš„æ€§èƒ½æ•°æ®ï¼‰
python test_chunk_size_optimization.py
```

## ğŸ“Š æµ‹è¯•å†…å®¹

### ğŸ§® GAFè®¡ç®—ä¼˜åŒ–
- **æµ‹è¯•é¡¹ç›®**: Summation GAF å’Œ Difference GAF çŸ©é˜µç”Ÿæˆ
- **å¤„ç†æ¨¡å¼**: 
  - æ ‡å‡†å¤šè¿›ç¨‹ (ProcessPoolExecutor)
  - å…±äº«å†…å­˜å¤šè¿›ç¨‹ (Shared Memory + ProcessPoolExecutor)
- **æµ‹è¯•å‚æ•°**: ä¸åŒçš„å—å¤§å° (50, 100, 200, 300, 500, 800, 1000, 1500, 2000)
- **æµ‹è¯•è¿›ç¨‹æ•°**: 2, 4, 6, 8, 12ä¸ªè¿›ç¨‹

### ğŸ”„ æ•°æ®ç±»å‹è½¬æ¢ä¼˜åŒ–
- **æµ‹è¯•é¡¹ç›®**: float32 â†’ uint8/uint16 æ•°æ®ç±»å‹è½¬æ¢
- **å¤„ç†æ¨¡å¼**:
  - æ ‡å‡†å¤šçº¿ç¨‹ (ThreadPoolExecutor)  
  - å…±äº«å†…å­˜å¤šçº¿ç¨‹ (Shared Memory + ThreadPoolExecutor)
- **æµ‹è¯•å‚æ•°**: ç›¸åŒçš„å—å¤§å°èŒƒå›´
- **æµ‹è¯•çº¿ç¨‹æ•°**: 4, 8, 12ä¸ªçº¿ç¨‹

### ğŸ“ åŸºå‡†æµ‹è¯•
- **å•çº¿ç¨‹GAFç”Ÿæˆ**: å»ºç«‹æ€§èƒ½åŸºå‡†
- **å•çº¿ç¨‹æ•°æ®è½¬æ¢**: å»ºç«‹è½¬æ¢åŸºå‡†
- **å†…å­˜ä½¿ç”¨ç›‘æ§**: å®æ—¶ç›‘æ§å†…å­˜å˜åŒ–
- **CPUä½¿ç”¨ç‡ç»Ÿè®¡**: è®°å½•CPUè´Ÿè½½

## ğŸ“ˆ è¾“å‡ºç»“æœ

### æ§åˆ¶å°è¾“å‡º
```
ğŸ”¬ å—å¤§å°ä¼˜åŒ–æµ‹è¯•è„šæœ¬
============================================================
ğŸ–¥ï¸  CPUæ ¸å¿ƒæ•°: 16
ğŸ’¾ æ€»å†…å­˜: 64.0GB
ğŸ”¢ æµ‹è¯•æ ·æœ¬æ•°: 5000

ğŸ“Š æµ‹è¯•æ•°æ®ç”Ÿæˆå®Œæˆ: (5000, 96, 12)
ğŸ’» æ•°æ®å¤§å°: 0.22GB

=== å•çº¿ç¨‹åŸºå‡†æµ‹è¯• ===
...
ğŸ“ˆ å•çº¿ç¨‹åŸºå‡†ç»“æœ:
   gaf_summation_time: 45.23s
   conversion_uint8_time: 12.34s

=== GAFè®¡ç®—å—å¤§å°ä¼˜åŒ–æµ‹è¯• ===
...
   ğŸ“Š æ ‡å‡†å¤šè¿›ç¨‹: 8.45s (åŠ é€Ÿ: 5.35x)
   ğŸš€ å…±äº«å†…å­˜: 7.21s (åŠ é€Ÿ: 6.27x)
   âœ… ç»“æœä¸€è‡´æ€§: True

=== ç»“æœåˆ†æä¸æ¨è ===
ğŸ¯ ç³»ç»Ÿæ¨èé…ç½® (åŸºäºå½“å‰ç¡¬ä»¶: 16æ ¸, 64.0GB):
   ğŸ§® GAFè®¡ç®—æ¨è:
      8è¿›ç¨‹ - æ ‡å‡†: 500 (5.35x), å…±äº«å†…å­˜: 800 (6.27x)
   ğŸ”„ æ•°æ®è½¬æ¢æ¨è:
      8çº¿ç¨‹ - æ ‡å‡†: 200 (4.12x), å…±äº«å†…å­˜: 300 (4.58x)
```

### ä¿å­˜çš„æ–‡ä»¶
```
test_results/
â”œâ”€â”€ gaf_chunk_size_results.csv      # GAFæµ‹è¯•è¯¦ç»†ç»“æœ
â”œâ”€â”€ conversion_chunk_size_results.csv  # è½¬æ¢æµ‹è¯•è¯¦ç»†ç»“æœ
â””â”€â”€ baseline_results.csv              # åŸºå‡†æµ‹è¯•ç»“æœ
```

## ğŸ¯ ç»“æœè§£è¯»

### æœ€ä¼˜é…ç½®æ¨è

åŸºäºæµ‹è¯•ç»“æœï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ¨èï¼š

1. **GAFè®¡ç®—æœ€ä¼˜é…ç½®**:
   - è¿›ç¨‹æ•°: é€šå¸¸ä¸ºCPUæ ¸å¿ƒæ•°-2åˆ°CPUæ ¸å¿ƒæ•°
   - å—å¤§å°: æ ¹æ®å†…å­˜å¤§å°ï¼Œé€šå¸¸åœ¨200-800ä¹‹é—´
   - å¤„ç†æ¨¡å¼: å…±äº«å†…å­˜é€šå¸¸æ¯”æ ‡å‡†å¤šè¿›ç¨‹å¿«10-20%

2. **æ•°æ®è½¬æ¢æœ€ä¼˜é…ç½®**:
   - çº¿ç¨‹æ•°: CPUæ ¸å¿ƒæ•°çš„50%-100%
   - å—å¤§å°: é€šå¸¸æ¯”GAFè®¡ç®—çš„å—å¤§å°å°ï¼Œåœ¨100-500ä¹‹é—´
   - å¤„ç†æ¨¡å¼: å…±äº«å†…å­˜é€‚åˆå¤§æ•°æ®ï¼Œæ ‡å‡†å¤šçº¿ç¨‹é€‚åˆä¸­å°æ•°æ®

### æ€§èƒ½æŒ‡æ ‡è§£è¯»

- **åŠ é€Ÿæ¯” (Speedup)**: ç›¸å¯¹äºå•çº¿ç¨‹çš„æ€§èƒ½æå‡å€æ•°
  - 2-3x: ä¸€èˆ¬æ€§èƒ½æå‡
  - 4-6x: è‰¯å¥½æ€§èƒ½æå‡  
  - 6x+: ä¼˜ç§€æ€§èƒ½æå‡

- **ç»“æœä¸€è‡´æ€§**: éªŒè¯å¹¶è¡Œå¤„ç†ç»“æœçš„æ­£ç¡®æ€§
  - True: å¹¶è¡Œç»“æœä¸å•çº¿ç¨‹ç»“æœä¸€è‡´
  - False: å­˜åœ¨è®¡ç®—è¯¯å·®ï¼Œéœ€è¦æ£€æŸ¥é…ç½®

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æµ‹è¯•å‚æ•°
```python
# åœ¨è„šæœ¬ä¸­ä¿®æ”¹è¿™äº›å‚æ•°
test_samples = 5000  # æµ‹è¯•æ ·æœ¬æ•°
chunk_sizes = [50, 100, 200, 500, 1000]  # æµ‹è¯•çš„å—å¤§å°
n_jobs_list = [4, 8, 12]  # æµ‹è¯•çš„è¿›ç¨‹/çº¿ç¨‹æ•°
```

### é’ˆå¯¹ç‰¹å®šç¡¬ä»¶ä¼˜åŒ–
```python
# å¤§å†…å­˜æœåŠ¡å™¨ (32GB+)
chunk_sizes = [200, 500, 800, 1000, 1500]
n_jobs_list = [8, 12, 16]

# ä¸­ç­‰æœåŠ¡å™¨ (16GB)  
chunk_sizes = [100, 200, 300, 500, 800]
n_jobs_list = [4, 6, 8]

# å°æœåŠ¡å™¨ (8GB)
chunk_sizes = [50, 100, 200, 300]
n_jobs_list = [2, 4, 6]
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å†…å­˜ä¸è¶³é”™è¯¯**:
   ```
   è§£å†³æ–¹æ¡ˆ: å‡å°‘test_samplesæˆ–chunk_size
   å»ºè®®: test_samples=1000, chunk_sizes=[50, 100, 200]
   ```

2. **å…±äº«å†…å­˜æµ‹è¯•å¤±è´¥**:
   ```
   åŸå› : Windowsç³»ç»Ÿæˆ–æ—§ç‰ˆPythonå¯èƒ½ä¸æ”¯æŒ
   è§£å†³: æµ‹è¯•ä¼šè‡ªåŠ¨å›é€€åˆ°æ ‡å‡†å¤šè¿›ç¨‹/å¤šçº¿ç¨‹
   ```

3. **è¿›ç¨‹æ•°è¿‡å¤šå¯¼è‡´æ€§èƒ½ä¸‹é™**:
   ```
   åŸå› : ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§äºå¹¶è¡Œæ”¶ç›Š
   å»ºè®®: å‡å°‘n_jobsåˆ°CPUæ ¸å¿ƒæ•°çš„50-75%
   ```

### ç³»ç»Ÿè¦æ±‚

- **æœ€ä½é…ç½®**: 4æ ¸CPU, 8GB RAM
- **æ¨èé…ç½®**: 8æ ¸CPU, 16GB+ RAM  
- **ç†æƒ³é…ç½®**: 16æ ¸CPU, 32GB+ RAM

- **ä¾èµ–åº“**: 
  ```bash
  pip install numpy pandas psutil pyts scikit-learn
  ```

## ğŸ“Š åº”ç”¨å»ºè®®

### å°†æµ‹è¯•ç»“æœåº”ç”¨åˆ°å®é™…é¡¹ç›®

1. **æ›´æ–°DualGAFDataLoaderé…ç½®**:
```python
# åŸºäºæµ‹è¯•ç»“æœæ›´æ–°é…ç½®
args.n_jobs = 8              # æ ¹æ®æµ‹è¯•æ¨èçš„è¿›ç¨‹æ•°
args.chunk_size = 500        # æ ¹æ®æµ‹è¯•æ¨èçš„å—å¤§å°
args.use_multiprocessing = True
args.use_shared_memory = True  # å¦‚æœå…±äº«å†…å­˜è¡¨ç°æ›´å¥½
```

2. **æ ¹æ®æ•°æ®è§„æ¨¡è°ƒæ•´**:
```python
# å¤§æ•°æ®é›† (>10000æ ·æœ¬)
recommended_chunk_size = max(test_result_chunk_size, 500)

# ä¸­ç­‰æ•°æ®é›† (1000-10000æ ·æœ¬)  
recommended_chunk_size = test_result_chunk_size

# å°æ•°æ®é›† (<1000æ ·æœ¬)
recommended_chunk_size = min(test_result_chunk_size, 200)
```

## ğŸ“ æ€§èƒ½è°ƒä¼˜æŠ€å·§

1. **å†…å­˜ä¼˜åŒ–**: 
   - ä½¿ç”¨uint8æ•°æ®ç±»å‹å‡å°‘75%å†…å­˜å ç”¨
   - å¯ç”¨æ•°æ®æŒä¹…åŒ–é¿å…é‡å¤å¤„ç†

2. **CPUä¼˜åŒ–**:
   - GAFè®¡ç®—ä½¿ç”¨å¤šè¿›ç¨‹ï¼ˆCPUå¯†é›†å‹ï¼‰
   - æ•°æ®è½¬æ¢ä½¿ç”¨å¤šçº¿ç¨‹ï¼ˆå†…å­˜è®¿é—®å¯†é›†å‹ï¼‰

3. **I/Oä¼˜åŒ–**:
   - åˆç†è®¾ç½®å—å¤§å°å¹³è¡¡å¹¶è¡Œåº¦å’Œé€šä¿¡å¼€é”€
   - é¿å…å—å¤§å°è¿‡å°å¯¼è‡´é¢‘ç¹è¿›ç¨‹é—´é€šä¿¡

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹ä¿å­˜çš„CSVç»“æœæ–‡ä»¶è¿›è¡Œè¯¦ç»†åˆ†æ
2. æ ¹æ®ç³»ç»Ÿç›‘æ§è°ƒæ•´æµ‹è¯•å‚æ•°
3. è€ƒè™‘ç¡¬ä»¶å‡çº§ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½

---

**æ³¨æ„**: æµ‹è¯•ç»“æœå¯èƒ½å› ç³»ç»Ÿè´Ÿè½½ã€ç¡¬ä»¶é…ç½®ç­‰å› ç´ è€Œå˜åŒ–ï¼Œå»ºè®®åœ¨ç›¸å¯¹ç©ºé—²çš„ç³»ç»Ÿç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ä»¥è·å¾—å‡†ç¡®ç»“æœã€‚ 