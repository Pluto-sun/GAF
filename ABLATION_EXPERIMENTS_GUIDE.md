# åŒè·¯GAFç½‘ç»œæ¶ˆèå®éªŒæŒ‡å—

## ğŸ”¬ æ¦‚è¿°

æ¶ˆèå®éªŒæ˜¯éªŒè¯æ¨¡å‹å„ç»„ä»¶æœ‰æ•ˆæ€§çš„é‡è¦æ–¹æ³•ã€‚æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨åŒè·¯GAFç½‘ç»œçš„æ¶ˆèå®éªŒåŠŸèƒ½æ¥è¯æ˜æ¯ä¸ªæ¨¡å—çš„è´¡çŒ®ã€‚

## ğŸ“‹ æ”¯æŒçš„æ¶ˆèå®éªŒ

### 1. GAFå·®åˆ†åˆ†æ”¯æ¶ˆè
- **æ§åˆ¶å‚æ•°**: `--use_diff_branch False`
- **ä½œç”¨**: ç¦ç”¨å·®åˆ†åˆ†æ”¯ï¼Œä»…ä½¿ç”¨sumåˆ†æ”¯è¿›è¡Œç‰¹å¾æå–
- **ç›®çš„**: éªŒè¯GAFèåˆï¼ˆsum + diffï¼‰ç›¸æ¯”å•ä¸€GAFçš„ä¼˜åŠ¿

### 2. ç»Ÿè®¡ç‰¹å¾æ¶ˆè
- **æ§åˆ¶å‚æ•°**: `--use_statistical_features False`
- **ä½œç”¨**: ç¦ç”¨æ—¶åºç»Ÿè®¡ç‰¹å¾æå–å’Œå¤šæ¨¡æ€èåˆ
- **ç›®çš„**: éªŒè¯ç»Ÿè®¡ç‰¹å¾å¯¹å¤šæ¨¡æ€å­¦ä¹ çš„è´¡çŒ®

### 3. æ³¨æ„åŠ›æœºåˆ¶æ¶ˆè
- **æ§åˆ¶å‚æ•°**: `--attention_type none`
- **ä½œç”¨**: ç¦ç”¨ä¿¡å·æ³¨æ„åŠ›æ¨¡å—
- **ç›®çš„**: éªŒè¯æ³¨æ„åŠ›æœºåˆ¶å¯¹ä¿¡å·å»ºæ¨¡çš„é‡è¦æ€§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1ï¼šä½¿ç”¨æ¶ˆèæ¨¡å¼å¿«æ·è®¾ç½®

```bash
# å®Œæ•´æ¨¡å‹ï¼ˆåŸºçº¿ï¼‰
python run.py --model DualGAFNet --data SAHU --ablation_mode none

# ç§»é™¤å·®åˆ†åˆ†æ”¯
python run.py --model DualGAFNet --data SAHU --ablation_mode no_diff

# ç§»é™¤ç»Ÿè®¡ç‰¹å¾
python run.py --model DualGAFNet --data SAHU --ablation_mode no_stat

# ç§»é™¤æ³¨æ„åŠ›æœºåˆ¶
python run.py --model DualGAFNet --data SAHU --ablation_mode no_attention

# æœ€ç®€åŒ–æ¨¡å‹ï¼ˆç§»é™¤æ‰€æœ‰é«˜çº§ç»„ä»¶ï¼‰
python run.py --model DualGAFNet --data SAHU --ablation_mode minimal
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨è®¾ç½®å„ä¸ªå¼€å…³

```bash
# è‡ªå®šä¹‰æ¶ˆèç»„åˆ
python run.py --model DualGAFNet --data SAHU \
    --use_diff_branch False \
    --use_statistical_features True \
    --attention_type channel

# ç»„åˆæ¶ˆèï¼šç§»é™¤å·®åˆ†åˆ†æ”¯å’Œæ³¨æ„åŠ›
python run.py --model DualGAFNet --data SAHU \
    --use_diff_branch False \
    --attention_type none
```

## ğŸ“Š æµ‹è¯•ç»“æœåˆ†æ

### æ¨¡å‹å¤æ‚åº¦å¯¹æ¯”

| å®éªŒé…ç½® | å‚æ•°æ•°é‡ | æ¨¡å‹å¤§å°(MB) | æ¨ç†æ—¶é—´(ms) | å¤æ‚åº¦å‡å°‘ |
|---------|---------|-------------|-------------|-----------|
| å®Œæ•´æ¨¡å‹ï¼ˆåŸºçº¿ï¼‰ | 26,934,845 | 102.75 | 15.64* | - |
| ç§»é™¤å·®åˆ†åˆ†æ”¯ | 15,742,685 | 60.05 | 4.14 | â†“41.5% |
| ç§»é™¤ç»Ÿè®¡ç‰¹å¾ | 26,901,437 | 102.62 | 10.36 | â†“0.1% |
| ç§»é™¤æ³¨æ„åŠ›æœºåˆ¶ | 26,934,660 | 102.75 | 10.69 | â†“0.0% |
| æœ€ç®€åŒ–æ¨¡å‹ | 15,709,092 | 59.93 | 3.38 | â†“41.7% |

*æ³¨ï¼šç¬¬ä¸€æ¬¡è¿è¡ŒåŒ…å«åˆå§‹åŒ–æ—¶é—´

### å…³é”®å‘ç°

1. **å·®åˆ†åˆ†æ”¯çš„å½±å“æœ€å¤§**ï¼š
   - ç§»é™¤åå‚æ•°å‡å°‘41.5%ï¼Œæ¨ç†æ—¶é—´å¤§å¹…é™ä½
   - è¡¨æ˜GAFèåˆæ˜¯è®¡ç®—å¤æ‚åº¦çš„ä¸»è¦æ¥æº

2. **ç»Ÿè®¡ç‰¹å¾å½±å“è¾ƒå°**ï¼š
   - å‚æ•°æ•°é‡å‡ ä¹æ— å˜åŒ–
   - ä¸»è¦å½±å“å¤šæ¨¡æ€å­¦ä¹ èƒ½åŠ›

3. **æ³¨æ„åŠ›æœºåˆ¶å¼€é”€å¾ˆä½**ï¼š
   - å‚æ•°å¢åŠ å¾®ä¹å…¶å¾®
   - æ€§ä»·æ¯”å¾ˆé«˜çš„ç»„ä»¶

## ğŸ”§ è¯¦ç»†é…ç½®å‚æ•°

### æ¶ˆèå®éªŒå¼€å…³

```python
# åœ¨run.pyä¸­çš„å‚æ•°è®¾ç½®
parser.add_argument('--use_diff_branch', action='store_true', default=True,
                   help='æ˜¯å¦ä½¿ç”¨å·®åˆ†åˆ†æ”¯è¿›è¡ŒGAFèåˆ')

parser.add_argument('--ablation_mode', type=str, default='none',
                   choices=['none', 'no_diff', 'no_stat', 'no_attention', 'minimal'],
                   help='æ¶ˆèå®éªŒæ¨¡å¼å¿«æ·è®¾ç½®')
```

### æ”¯æŒçš„æ¶ˆèæ¨¡å¼

| æ¨¡å¼ | æè¿° | ç­‰ä»·è®¾ç½® |
|-----|------|---------|
| `none` | å®Œæ•´æ¨¡å‹ | æ‰€æœ‰ç»„ä»¶å¯ç”¨ |
| `no_diff` | ç§»é™¤å·®åˆ†åˆ†æ”¯ | `use_diff_branch=False` |
| `no_stat` | ç§»é™¤ç»Ÿè®¡ç‰¹å¾ | `use_statistical_features=False` |
| `no_attention` | ç§»é™¤æ³¨æ„åŠ›æœºåˆ¶ | `attention_type=none` |
| `minimal` | æœ€ç®€åŒ–æ¨¡å‹ | æ‰€æœ‰é«˜çº§ç»„ä»¶ç¦ç”¨ |

## ğŸ“ˆ æ¨èçš„å®éªŒæµç¨‹

### 1. åŸºçº¿å®éªŒ
```bash
python run.py --model DualGAFNet --data SAHU --step 72 --seq_len 72 \
    --train_epochs 20 --batch_size 4 --feature_dim 32 \
    --use_statistical_features --use_diff_branch --attention_type channel \
    --des "baseline_full_model"
```

### 2. å•ä¸€ç»„ä»¶æ¶ˆè
```bash
# å®éªŒAï¼šç§»é™¤å·®åˆ†åˆ†æ”¯
python run.py --model DualGAFNet --data SAHU --step 72 --seq_len 72 \
    --train_epochs 20 --batch_size 4 --feature_dim 32 \
    --ablation_mode no_diff --des "ablation_no_diff"

# å®éªŒBï¼šç§»é™¤ç»Ÿè®¡ç‰¹å¾
python run.py --model DualGAFNet --data SAHU --step 72 --seq_len 72 \
    --train_epochs 20 --batch_size 4 --feature_dim 32 \
    --ablation_mode no_stat --des "ablation_no_stat"

# å®éªŒCï¼šç§»é™¤æ³¨æ„åŠ›æœºåˆ¶
python run.py --model DualGAFNet --data SAHU --step 72 --seq_len 72 \
    --train_epochs 20 --batch_size 4 --feature_dim 32 \
    --ablation_mode no_attention --des "ablation_no_attention"
```

### 3. ç»„åˆæ¶ˆèå®éªŒ
```bash
# å®éªŒDï¼šç§»é™¤å·®åˆ†åˆ†æ”¯ + ç»Ÿè®¡ç‰¹å¾
python run.py --model DualGAFNet --data SAHU --step 72 --seq_len 72 \
    --train_epochs 20 --batch_size 4 --feature_dim 32 \
    --use_diff_branch False --use_statistical_features False \
    --des "ablation_no_diff_no_stat"

# å®éªŒEï¼šæœ€ç®€åŒ–æ¨¡å‹
python run.py --model DualGAFNet --data SAHU --step 72 --seq_len 72 \
    --train_epochs 20 --batch_size 4 --feature_dim 32 \
    --ablation_mode minimal --des "ablation_minimal"
```

## ğŸ“Š ç»“æœè¯„ä¼°æŒ‡æ ‡

### 1. æ€§èƒ½æŒ‡æ ‡
- **å‡†ç¡®ç‡ (Accuracy)**: æ•´ä½“åˆ†ç±»æ€§èƒ½
- **F1åˆ†æ•° (F1-score)**: å¹³è¡¡ç²¾ç¡®ç‡å’Œå¬å›ç‡
- **ç²¾ç¡®ç‡ (Precision)**: æ­£ç¡®é¢„æµ‹çš„æ­£æ ·æœ¬æ¯”ä¾‹
- **å¬å›ç‡ (Recall)**: å®é™…æ­£æ ·æœ¬è¢«æ­£ç¡®é¢„æµ‹çš„æ¯”ä¾‹

### 2. æ•ˆç‡æŒ‡æ ‡
- **å‚æ•°æ•°é‡**: æ¨¡å‹å¤æ‚åº¦
- **æ¨ç†æ—¶é—´**: è®¡ç®—æ•ˆç‡
- **å†…å­˜å ç”¨**: èµ„æºéœ€æ±‚
- **è®­ç»ƒæ—¶é—´**: æ”¶æ•›é€Ÿåº¦

### 3. åˆ†æç»´åº¦
- **ç»„ä»¶è´¡çŒ®åº¦**: (åŸºçº¿æ€§èƒ½ - æ¶ˆèæ€§èƒ½) / åŸºçº¿æ€§èƒ½
- **å¤æ‚åº¦æ”¶ç›Š**: æ€§èƒ½æå‡ / å¤æ‚åº¦å¢åŠ 
- **è®¡ç®—æ•ˆç‡**: æ€§èƒ½ / æ¨ç†æ—¶é—´

## ğŸ¯ å®é™…åº”ç”¨å»ºè®®

### 1. äº§å“éƒ¨ç½²åœºæ™¯
- **é«˜æ€§èƒ½è¦æ±‚**: ä½¿ç”¨å®Œæ•´æ¨¡å‹
- **èµ„æºå—é™**: è€ƒè™‘ç§»é™¤å·®åˆ†åˆ†æ”¯ï¼ˆå‡å°‘41%å‚æ•°ï¼‰
- **å®æ—¶æ€§è¦æ±‚**: ä½¿ç”¨æœ€ç®€åŒ–æ¨¡å‹ï¼ˆæœ€å¿«æ¨ç†ï¼‰

### 2. ç ”ç©¶éªŒè¯åœºæ™¯
- **è®ºæ–‡å†™ä½œ**: å®Œæ•´çš„æ¶ˆèå®éªŒå¢å¼ºå¯ä¿¡åº¦
- **ç»„ä»¶ä¼˜åŒ–**: è¯†åˆ«æ€§ä»·æ¯”æœ€é«˜çš„ç»„ä»¶
- **æ¶æ„è®¾è®¡**: æŒ‡å¯¼åç»­æ¨¡å‹æ”¹è¿›æ–¹å‘

### 3. è°ƒè¯•å’Œä¼˜åŒ–
- **æ€§èƒ½å¼‚å¸¸**: é€šè¿‡æ¶ˆèå®šä½é—®é¢˜ç»„ä»¶
- **è¿‡æ‹Ÿåˆé—®é¢˜**: ç®€åŒ–æ¨¡å‹é™ä½å¤æ‚åº¦
- **è®­ç»ƒä¸ç¨³å®š**: é€æ­¥æ·»åŠ ç»„ä»¶æ‰¾åˆ°å¹³è¡¡ç‚¹

## ğŸ” è¯¦ç»†æµ‹è¯•ç¤ºä¾‹

### è¿è¡Œæ¶ˆèå®éªŒæµ‹è¯•
```bash
# åˆ‡æ¢åˆ°test_envç¯å¢ƒï¼ˆå¦‚æœéœ€è¦ï¼‰
conda activate test_env

# è¿è¡Œæ¶ˆèå®éªŒæµ‹è¯•è„šæœ¬
python test_ablation_experiments.py

# æˆ–ä½¿ç”¨æä¾›çš„è¿è¡Œè„šæœ¬
chmod +x scripts/run_ablation_experiments.sh
./scripts/run_ablation_experiments.sh
```

### æµ‹è¯•è¾“å‡ºç¤ºä¾‹
```
ğŸ”¬ æ¶ˆèå®éªŒçŠ¶æ€: GAFå·®åˆ†åˆ†æ”¯æ¶ˆè
   âŒ ç¦ç”¨å·®åˆ†åˆ†æ”¯ (use_diff_branch=False)
   
ğŸ”§ å‚æ•°æ•°é‡: 15,742,685 (è®­ç»ƒ: 15,742,685)
ğŸ’¾ æ¨¡å‹å¤§å°: 60.05 MB
âš¡ æ¨ç†æ—¶é—´: 4.14ms
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. æ•°æ®æ ¼å¼è¦æ±‚
- **å¯ç”¨ç»Ÿè®¡ç‰¹å¾æ—¶**: å¿…é¡»æä¾›time_series_xæ•°æ®
- **ç¦ç”¨ç»Ÿè®¡ç‰¹å¾æ—¶**: å¯ä»¥ä¸æä¾›time_series_xï¼Œä½†æ•°æ®åŠ è½½å™¨éœ€è¦å…¼å®¹

### 2. å‚æ•°å…¼å®¹æ€§
- æ¶ˆèå®éªŒä¼šè‡ªåŠ¨è°ƒæ•´ç›¸å…³å‚æ•°
- æ‰‹åŠ¨è®¾ç½®çš„å‚æ•°ä¼˜å…ˆçº§é«˜äºè‡ªåŠ¨è®¾ç½®

### 3. ç»“æœè§£é‡Š
- ç¬¬ä¸€æ¬¡è¿è¡Œæ¨ç†æ—¶é—´å¯èƒ½è¾ƒé•¿ï¼ˆåŒ…å«åˆå§‹åŒ–ï¼‰
- å…³æ³¨ç›¸å¯¹æ€§èƒ½å˜åŒ–è€Œéç»å¯¹æ•°å€¼
- è€ƒè™‘å¤šæ¬¡è¿è¡Œå–å¹³å‡å€¼å¢åŠ å¯é æ€§

## ğŸ“š æ‰©å±•é˜…è¯»

- **æ¶ˆèå®éªŒåŸç†**: é€šè¿‡ç§»é™¤ç»„ä»¶éªŒè¯å…¶å¿…è¦æ€§
- **åŒè·¯GAFç½‘ç»œæ¶æ„**: ç†è§£å„ç»„ä»¶çš„è®¾è®¡ç›®çš„
- **HVACå¼‚å¸¸æ£€æµ‹**: äº†è§£å…·ä½“åº”ç”¨åœºæ™¯éœ€æ±‚
- **æ¨¡å‹ä¼˜åŒ–ç­–ç•¥**: æ ¹æ®æ¶ˆèç»“æœæŒ‡å¯¼ä¼˜åŒ–æ–¹å‘

---

## ğŸ’¡ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å®Œæ•´æ¨¡å‹æµ‹è¯•
python run.py --model DualGAFNet --data SAHU --des "full_model"

# ç§»é™¤å·®åˆ†åˆ†æ”¯
python run.py --model DualGAFNet --data SAHU --ablation_mode no_diff

# ç§»é™¤ç»Ÿè®¡ç‰¹å¾  
python run.py --model DualGAFNet --data SAHU --ablation_mode no_stat

# ç§»é™¤æ³¨æ„åŠ›æœºåˆ¶
python run.py --model DualGAFNet --data SAHU --ablation_mode no_attention

# æœ€ç®€åŒ–æ¨¡å‹
python run.py --model DualGAFNet --data SAHU --ablation_mode minimal

# è‡ªå®šä¹‰ç»„åˆ
python run.py --model DualGAFNet --data SAHU \
    --use_diff_branch False --attention_type none
```

é€šè¿‡ç³»ç»Ÿæ€§çš„æ¶ˆèå®éªŒï¼Œæ‚¨å¯ä»¥æ·±å…¥ç†è§£åŒè·¯GAFç½‘ç»œå„ç»„ä»¶çš„è´¡çŒ®ï¼Œä¸ºæ¨¡å‹ä¼˜åŒ–å’Œå®é™…éƒ¨ç½²æä¾›ç§‘å­¦ä¾æ®ã€‚ 